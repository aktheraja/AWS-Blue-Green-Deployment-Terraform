{
  "version": 4,
  "terraform_version": "0.12.0",
  "serial": 58,
  "lineage": "bdb242a0-5045-a18b-1b7e-7d9e4ede2d31",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "lifecycle",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::632199730033:policy/tf_lambda_vpc_policy",
            "description": "",
            "id": "arn:aws:iam::632199730033:policy/tf_lambda_vpc_policy",
            "name": "tf_lambda_vpc_policy",
            "name_prefix": null,
            "path": "/",
            "policy": "{\r\n\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Effect\": \"Allow\",\r\n            \"Action\": \"*\",\r\n            \"Resource\": \"*\"\r\n        }\r\n    ]\r\n\r\n}\r\n\r\n"
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy_attachment",
      "name": "lifecycle",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "groups": null,
            "id": "tf-iam-role-attachment-lifecycle",
            "name": "tf-iam-role-attachment-lifecycle",
            "policy_arn": "arn:aws:iam::632199730033:policy/tf_lambda_vpc_policy",
            "roles": [
              "iam_for_lambda_with_sns"
            ],
            "users": null
          },
          "depends_on": [
            "aws_iam_policy.lifecycle",
            "aws_iam_role.default"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "default",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::632199730033:role/iam_for_lambda_with_sns",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2019-07-16T22:10:59Z",
            "description": "",
            "force_detach_policies": false,
            "id": "iam_for_lambda_with_sns",
            "max_session_duration": 3600,
            "name": "iam_for_lambda_with_sns",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": null,
            "unique_id": "AROAZGMQKKNY5EC7IG24D"
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "func",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-west-2:632199730033:function:lambda_called_from_sns",
            "dead_letter_config": [],
            "description": "",
            "environment": [
              {
                "variables": {
                  "ami": "ami-07669fc90e6e6cc47",
                  "asg_blue": "asg_blue",
                  "asg_green": "asg_green"
                }
              }
            ],
            "filename": "Terraform_lambda.zip",
            "function_name": "lambda_called_from_sns",
            "handler": "Terraform_lambda.lambda_handler",
            "id": "lambda_called_from_sns",
            "invoke_arn": "arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:632199730033:function:lambda_called_from_sns/invocations",
            "kms_key_arn": "",
            "last_modified": "2019-07-16T22:11:16.587+0000",
            "layers": null,
            "memory_size": 512,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-2:632199730033:function:lambda_called_from_sns:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::632199730033:role/iam_for_lambda_with_sns",
            "runtime": "python2.7",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "5+TosMl8UteGl3BJuYcMatowG93PCryaKxb4Qs676NQ=",
            "source_code_size": 2246,
            "tags": null,
            "timeout": 900,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "depends_on": [
            "aws_iam_role.default"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "with_sns",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "lambda_called_from_sns",
            "id": "AllowExecutionFromSNS",
            "principal": "sns.amazonaws.com",
            "qualifier": "",
            "source_account": null,
            "source_arn": "arn:aws:sns:us-west-2:632199730033:call-lambda-maybe",
            "statement_id": "AllowExecutionFromSNS",
            "statement_id_prefix": null
          },
          "depends_on": [
            "aws_lambda_function.func",
            "aws_sns_topic.default",
            "aws_sns_topic_subscription.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic",
      "name": "default",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_failure_feedback_role_arn": "",
            "application_success_feedback_role_arn": "",
            "application_success_feedback_sample_rate": 0,
            "arn": "arn:aws:sns:us-west-2:632199730033:call-lambda-maybe",
            "delivery_policy": "",
            "display_name": "",
            "http_failure_feedback_role_arn": "",
            "http_success_feedback_role_arn": "",
            "http_success_feedback_sample_rate": 0,
            "id": "arn:aws:sns:us-west-2:632199730033:call-lambda-maybe",
            "kms_master_key_id": "",
            "lambda_failure_feedback_role_arn": "",
            "lambda_success_feedback_role_arn": "",
            "lambda_success_feedback_sample_rate": 0,
            "name": "call-lambda-maybe",
            "name_prefix": null,
            "policy": "{\"Version\":\"2008-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__default_statement_ID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Action\":[\"SNS:GetTopicAttributes\",\"SNS:SetTopicAttributes\",\"SNS:AddPermission\",\"SNS:RemovePermission\",\"SNS:DeleteTopic\",\"SNS:Subscribe\",\"SNS:ListSubscriptionsByTopic\",\"SNS:Publish\",\"SNS:Receive\"],\"Resource\":\"arn:aws:sns:us-west-2:632199730033:call-lambda-maybe\",\"Condition\":{\"StringEquals\":{\"AWS:SourceOwner\":\"632199730033\"}}}]}",
            "sqs_failure_feedback_role_arn": "",
            "sqs_success_feedback_role_arn": "",
            "sqs_success_feedback_sample_rate": 0,
            "tags": null
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_sns_topic_subscription",
      "name": "lambda",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sns:us-west-2:632199730033:call-lambda-maybe:19b4ee83-2c22-4398-97c4-503ad9cfd699",
            "confirmation_timeout_in_minutes": 1,
            "delivery_policy": "",
            "endpoint": "arn:aws:lambda:us-west-2:632199730033:function:lambda_called_from_sns",
            "endpoint_auto_confirms": false,
            "filter_policy": "",
            "id": "arn:aws:sns:us-west-2:632199730033:call-lambda-maybe:19b4ee83-2c22-4398-97c4-503ad9cfd699",
            "protocol": "lambda",
            "raw_message_delivery": false,
            "topic_arn": "arn:aws:sns:us-west-2:632199730033:call-lambda-maybe"
          },
          "depends_on": [
            "aws_lambda_function.func",
            "aws_sns_topic.default"
          ]
        }
      ]
    }
  ]
}
